col0,col1,col2,col3,col4,col5,col6,col7,col8,col9,col10,col11,col12,col13
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,resources[0],364,App Service must be deployed on a minimum of two instances to ensure availability,.\templates\Microsoft.Web\sites\appService.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',resources[0],364,App Service must authenticate users using Azure Active Directory backed credentials,.\templates\Microsoft.Web\sites\appService.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,resources[0].properties.siteConfig.siteAuthSettings.clientId,408,"""[parameters('clientId')]""",$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,resources[0],364,App Service must authenticate users using Azure Active Directory backed credentials,.\templates\Microsoft.Web\sites\appService.json
Azure_ContainerInstances_AuthZ_Container_Segregation,ContainerInstances,Failed,Microsoft.ContainerInstance/containerGroups,High,resources[0].properties.containers,101,"""[parameters('containers')]""",$.properties.containers,Count LesserThan 2,resources[0],94,A container group must contain only containers which trust each other,.\templates\Microsoft.ContainerInstance\containerGroups\containerGroup.json
Azure_ContainerRegistry_DP_Enable_Content_Trust,ContainerRegistry,Failed,"Microsoft.ContainerRegistry/registries , Microsoft.ContainerRegistry/registries/webhooks",Medium,Not found,-1,,$.properties.policies.trustPolicy.status,Allow 'enabled',resources[0],173,Content trust must be enabled for the Container Registry,.\templates\Microsoft.ContainerRegistry\registries\registry.json
Azure_KubernetesService_Deploy_Use_Latest_Version,KubernetesService,Failed,Microsoft.ContainerService/ManagedClusters,Medium,resources[0].properties.kubernetesVersion,221,"""[parameters('kubernetesVersion')]""",$.properties.kubernetesVersion,GreaterThanOrEqual '1.15.7',resources[0],214,The latest version of Kubernetes should be used,.\templates\Microsoft.ContainerService\managedClusters\managedCluster.json
Azure_KubernetesService_Audit_Enable_Monitoring,KubernetesService,Failed,Microsoft.ContainerService/ManagedClusters,Medium,Not found,-1,,$.properties.addonProfiles.omsagent.enabled,'True',resources[0],214,Monitoring must be enabled for Azure Kubernetes Service,.\templates\Microsoft.ContainerService\managedClusters\managedCluster.json
Azure_KeyVault_AuthZ_Grant_Min_Access_policies,KeyVault,Verify,Microsoft.KeyVault/vaults,High,resources[0].properties.accessPolicies,166,"""[variables('accessPolicies').accessPolicies]""",$.properties.accessPolicies,Verify current value,resources[0],154,All Key Vault access policies must be defined with minimum required permissions to keys and secrets,D:\_work\1\s\templates\Microsoft.KeyVault\vaults\keyVault.json
Azure_SQLDatabase_Audit_Enable_Threat_Detection_Server,SqlServer,Failed,"Microsoft.Sql/servers , Microsoft.Sql/servers/databases , Microsoft.Sql/servers/databases/transparentDataEncryption , Microsoft.Sql/servers/databases/auditingSettings , Microsoft.Sql/servers/auditingSettings , Microsoft.Sql/servers/administrators , Microsoft.Sql/servers/securityAlertPolicies , Microsoft.Sql/servers/firewallrules",High,Not found,-1,,$.properties.emailAccountAdmins,'True',"resources[1] , resources[2] , resources[1] , resources[0] , resources[0]",113,Enable SQL Server threat detection with email admins option. Do not exclude any detection types,.\templates\Microsoft.Sql\servers\sqlServer.json
Azure_SQLDatabase_Audit_Enable_Threat_Detection_Server,SqlServer,Failed,"Microsoft.Sql/servers , Microsoft.Sql/servers/databases , Microsoft.Sql/servers/databases/transparentDataEncryption , Microsoft.Sql/servers/databases/auditingSettings , Microsoft.Sql/servers/auditingSettings , Microsoft.Sql/servers/administrators , Microsoft.Sql/servers/securityAlertPolicies , Microsoft.Sql/servers/firewallrules",High,Not found,-1,,$.properties.emailAddresses,Non-null string,"resources[1] , resources[2] , resources[1] , resources[0] , resources[0]",113,Enable SQL Server threat detection with email admins option. Do not exclude any detection types,.\templates\Microsoft.Sql\servers\sqlServer.json
Azure_SQLDatabase_Audit_Enable_Threat_Detection_Server,SqlServer,Failed,"Microsoft.Sql/servers , Microsoft.Sql/servers/databases , Microsoft.Sql/servers/databases/transparentDataEncryption , Microsoft.Sql/servers/databases/auditingSettings , Microsoft.Sql/servers/auditingSettings , Microsoft.Sql/servers/administrators , Microsoft.Sql/servers/securityAlertPolicies , Microsoft.Sql/servers/firewallrules",High,Not found,-1,,$.properties.disabledAlerts,Null string,"resources[1] , resources[2] , resources[1] , resources[0] , resources[0]",113,Enable SQL Server threat detection with email admins option. Do not exclude any detection types,.\templates\Microsoft.Sql\servers\sqlServer.json
Azure_SQLDatabase_DP_Enable_TDE,SqlServer,Failed,"Microsoft.Sql/servers , Microsoft.Sql/servers/databases , Microsoft.Sql/servers/databases/transparentDataEncryption , Microsoft.Sql/servers/databases/auditingSettings , Microsoft.Sql/servers/auditingSettings , Microsoft.Sql/servers/administrators , Microsoft.Sql/servers/securityAlertPolicies , Microsoft.Sql/servers/firewallrules",High,Not found,-1,,$.properties.status,Allow 'Enabled',"resources[1] , resources[2] , resources[1] , resources[0] , resources[0]",113,Transparent data encryption (TDE) must be enabled,.\templates\Microsoft.Sql\servers\sqlServer.json
Azure_LogicApps_AuthZ_Provide_Triggers_Access_Control,LogicApps,Failed,Microsoft.Logic/workflows,High,Not found,-1,,$.properties.accessControl.triggers.allowedCallerIpAddresses.addressRange,Verify current value,resources[0],132,If Logic App fires on an HTTP Request (e.g. Request or Webhook) then provide IP ranges for triggers to prevent unauthorized access,.\templates\Microsoft.Logic\workflows\secureScore.json
Azure_LogicApps_AuthZ_Provide_Contents_Access_Control,LogicApps,Failed,Microsoft.Logic/workflows,High,Not found,-1,,$.properties.accessControl.contents.allowedCallerIpAddresses.addressRange,Verify current value,resources[0],132,Must provide IP ranges for contents to prevent unauthorized access to inputs/outputs data of Logic App run history,.\templates\Microsoft.Logic\workflows\secureScore.json
